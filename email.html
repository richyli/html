<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Email Question Flow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-white text-gray-900">
    <div id="root" class="max-w-3xl mx-auto my-8"></div>

    <script type="text/babel">
      const { useState } = React;

      function EmailSimulationApp() {
        const [selections, setSelections] = useState({});
        const [currentEmailIndex, setCurrentEmailIndex] = useState(0);

        const handleSelect = (emailId, answer, section) => {
          setSelections((prev) => ({ ...prev, [emailId]: { answer, section } }));
          setCurrentEmailIndex((prev) => prev + 1);
        };

        const sectionContents = {
          "Section 1": "This is the content for Section 1.",
          "Section 2": "This is the content for Section 2.",
          "Section 3": "This is the content for Section 3.",
          "Section 4": "This is the content for Section 4.",
          "Section 5": "This is the content for Section 5.",
          "Section 6": "This is the content for Section 6.",
          "Section 7": "This is the content for Section 7.",
          "Section 8": "This is the content for Section 8.",
        };

        const emails = [
          {
            id: "email1",
            question: "Question 1",
            answers: [
              { label: "Answer 1", section: "Section 1" },
              { label: "Answer 2", section: "Section 2" },
            ],
          },
          {
            id: "email2",
            question: "Question 2",
            answers: [
              { label: "Answer 3", section: "Section 3" },
              { label: "Answer 4", section: "Section 4" },
            ],
          },
          {
            id: "email3",
            question: "Question 3",
            answers: [
              { label: "Answer 5", section: "Section 5" },
              { label: "Answer 6", section: "Section 6" },
            ],
          },
          {
            id: "email4",
            question: "Question 4",
            answers: [
              { label: "Answer 7", section: "Section 7" },
              { label: "Answer 8", section: "Section 8" },
            ],
          },
        ];

        return (
          <div className="p-6 space-y-8">
            {emails.map((email, index) => {
              if (index > currentEmailIndex) return null;

              return (
                <div key={email.id} className="border rounded-xl p-4 shadow-md">
                  {!selections[email.id] ? (
                    <>
                      <h2 className="text-lg font-semibold mb-2">{email.id.toUpperCase()}</h2>
                      <p className="mb-2">{email.question}</p>
                      <div className="space-x-4 mb-2">
                        {email.answers.map((ans, i) => (
                          <button
                            key={i}
                            onClick={() => handleSelect(email.id, ans.label, ans.section)}
                            className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                          >
                            {ans.label}
                          </button>
                        ))}
                      </div>
                    </>
                  ) : (
                    <div className="mt-4 p-3 bg-gray-100 rounded">
                      <h3 className="font-semibold">{selections[email.id].section}</h3>
                      <p>{sectionContents[selections[email.id].section]}</p>
                    </div>
                  )}
                </div>
              );
            })}

            {currentEmailIndex > 0 && (
              <div className="border-t pt-4 mt-4">
                <h2 className="text-lg font-bold mb-2">Previous Email Review</h2>
                <div className="bg-yellow-100 p-4 rounded">
                  {(() => {
                    const prevEmail = emails[currentEmailIndex - 1];
                    const prevData = selections[prevEmail.id];
                    return (
                      <div>
                        <p className="font-medium">{prevEmail.id.toUpperCase()}</p>
                        <p>Answer: {prevData.answer}</p>
                        <p>Section: {prevData.section}</p>
                      </div>
                    );
                  })()}
                </div>
              </div>
            )}

            {Object.keys(selections).length === 4 && (
              <div className="border-t pt-4 mt-8">
                <h2 className="text-xl font-bold mb-4">Final Section</h2>
                <ul className="list-disc list-inside">
                  {Object.entries(selections).map(([emailId, data]) => (
                    <li key={emailId}>
                      {emailId.toUpperCase()}: {data.answer} â†’ {data.section}
                    </li>
                  ))}
                </ul>
              </div>
            )}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<EmailSimulationApp />);
    </script>
  </body>
</html>
